(window.webpackJsonp=window.webpackJsonp||[]).push([[555],{1080:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ZK_SurveyValidate}));var _babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(58),_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(99),_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(100),core_js_modules_es6_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(50),core_js_modules_es6_object_to_string_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_object_to_string_js__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(89),core_js_modules_es6_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string_js__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_array_slice_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(72),core_js_modules_es6_array_slice_js__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_array_slice_js__WEBPACK_IMPORTED_MODULE_5__),survey_knockout__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(3),survey_knockout__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(survey_knockout__WEBPACK_IMPORTED_MODULE_6__),jquery__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(75),jquery__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_7__),element_ui__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(31),element_ui__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(element_ui__WEBPACK_IMPORTED_MODULE_8__),ZK_SurveyValidate=function(){function ZK_SurveyValidate(){Object(_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__.a)(this,ZK_SurveyValidate),this.survey=new survey_knockout__WEBPACK_IMPORTED_MODULE_6__.Survey,this.serverCache={AnswerSummary:[],QuesAnswerSummary:[],checkUserAnswered:[],checkUserAnsweredByDataSetId:[],findCurrentDateTime:[],findAnswerRanking:[]},this.registCustomeFunctionFactory("limitCount",this.limitCount),this.registCustomeFunctionFactory("limitPhone",this.limitPhone),this.registCustomeFunctionFactory("checkAnsweredByQId",this.checkAnsweredByQId),this.registCustomeFunctionFactory("checkAnsweredByDataSetId",this.checkAnsweredByDataSetId),this.registCustomeFunctionFactory("regexValidate",this.regexValidate),this.registCustomeFunctionFactory("serverTime",this.serverTime),this.registCustomeFunctionFactory("getMonth",this.getMonth),this.registCustomeFunctionFactory("getDate",this.getDate),this.registCustomeFunctionFactory("eval",this.eval),this.registCustomeFunctionFactory("saveRanking",this.saveRanking),this.registCustomeFunctionFactory("encrypt",this.encrypt),this.registCustomeFunctionFactory("decrypt",this.decrypt),this.unregistCustomeFunctionFactory("diffDays"),this.registCustomeFunctionFactory("diffDays",this.diffDays)}return Object(_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_2__.a)(ZK_SurveyValidate,[{key:"init",value:function(e){this.survey=e,Object.defineProperty(this.survey,"getServerCache",{value:this.getServerCache}),Object.defineProperty(this.survey,"setServerCache",{value:this.setServerCache}),Object.defineProperty(this.survey,"serverCache",{value:this.serverCache})}},{key:"regexValidate",value:function regexValidate(params){try{var value=JSON.parse(JSON.stringify(params[0])),regex=eval("/"+params[1]+"/g");return!value||("object"==Object(_babel_runtime_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_0__.a)(value)?regex.test(JSON.stringify(value)):regex.test(value))}catch(e){console.error(e)}}},{key:"limitCount",value:function(e){try{if(e.length<4)return element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.warning("方法limitCount参数不正确"),!1;var r=e[0],t=e[1],_=e[2],n=e[3];if(t!=_)return!0;var c=r,o=this.survey.getServerCache?this.survey.getServerCache("AnswerSummary",c):void 0;return void 0===o&&(o=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/AnswerSummary/"+this.survey.surveyId,data:r,method:"post",async:!1,dataType:"json",contentType:"application/json"}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("AnswerSummary",c,o)),!(t==_&&o&&o[_]>=n)}catch(e){console.error(e)}}},{key:"limitPhone",value:function(e){try{if(e.length<3)return element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.warning("方法limitPhone参数不正确"),!1;var r=e[0],t=e[1],_=e[3],n={};n[r]=t.toString();var data=JSON.stringify(n),c=this.survey.getServerCache?this.survey.getServerCache("QuesAnswerSummary",data):void 0;return void 0===c&&(c=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/QuesAnswerSummary/"+this.survey.surveyId,data:data,method:"post",async:!1,dataType:"json",contentType:"application/json"}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("QuesAnswerSummary",data,c)),!(c&&c[t]>=_)}catch(e){console.error(e)}}},{key:"checkAnsweredByQId",value:function(e){try{if(!this.survey.userKeyId)return!1;if(!e||0==e.length)return element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.warning("方法checkAnswered参数不正确"),!1;var r=JSON.stringify({qid:e[0],data:this.survey.userKeyId}),t=this.survey.getServerCache?this.survey.getServerCache("checkUserAnswered",r):void 0;return void 0===t&&(t=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/checkUserAnswered/"+e[0],data:this.survey.userKeyId,method:"post",async:!1,dataType:"json",contentType:"application/json",headers:{Authorization:this.survey.token}}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("checkUserAnswered",r,t)),t&&t.result||!1}catch(e){console.error(e)}}},{key:"checkAnsweredByDataSetId",value:function(e){try{if(!e||e.length<3)return element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.warning("方法checkAnswered参数不正确"),!1;var r=Array.isArray(e[1]);if(r)for(var i=0;i<e[2].length;i++)"number"==typeof e[2][i]&&(e[2][i]=JSON.stringify(e[2][i]));else"number"==typeof e[2]&&(e[2]=JSON.stringify(e[2]));var data=JSON.stringify({dataSetId:e[0],variableNames:r?e[1]:[e[1]],variableValues:r?e[2]:[e[2]]}),t=this.survey.getServerCache?this.survey.getServerCache("checkUserAnsweredByDataSetId",data):void 0;return void 0===t&&(t=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/checkUserAnsweredByDataSetId",data:data,method:"post",async:!1,dataType:"json",contentType:"application/json",headers:{Authorization:this.survey.token}}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("checkUserAnsweredByDataSetId",data,t)),t&&t.result||!1}catch(e){console.error(e)}}},{key:"serverTime",value:function(){try{var e="findCurrentDateTime",r=this.survey.getServerCache?this.survey.getServerCache("findCurrentDateTime",e):void 0;return void 0===r&&(r=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/findCurrentDateTime",method:"get",async:!1,dataType:"json",contentType:"application/json"}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("findCurrentDateTime",e,r)),r&&r.resultStatus&&r.result||""}catch(e){console.error(e)}}},{key:"getMonth",value:function(e){try{if(1!==e.length||!e[0])return;return new Date(e[0]).getMonth()+1}catch(e){console.error(e)}}},{key:"getDate",value:function(e){try{if(1!==e.length||!e[0])return;return new Date(e[0]).getDate()}catch(e){console.error(e)}}},{key:"diffDays",value:function(e){try{if(!Array.isArray(e)||2!==e.length)return 0;if(!e[0]||!e[1])return 0;var r=n(e[0]),t=n(e[1]),_=Math.abs(t-r);return Math.ceil(_/864e5)}catch(e){console.error(e)}function n(param){return"string"==typeof param&&param.length>10?new Date(param.slice(0,10)):new Date(param)}}},{key:"eval",value:function _eval(params){try{if(console.log(params),1!==params.length||!params[0])return;console.log(params[0]);try{return console.log(eval(params[0])),eval(params[0])}catch(e){return console.log(e),e}}catch(e){console.error(e)}}},{key:"saveRanking",value:function(e){try{var r=this.survey;if(!e||0==e.length)return element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.warning("方法saveRanking参数不正确"),!1;try{!function(){for(var t=e[0],_=[],i=1;i<e.length;i++)_.push(e[i][0]);if(r.updateAnswerRankingVOList)for(i=0;i<r.updateAnswerRankingVOList.length;i++){if(r.updateAnswerRankingVOList[i].targetVarName==t){r.updateAnswerRankingVOList[i].fieldValues=_;break}i==r.updateAnswerRankingVOList.length-1&&r.updateAnswerRankingVOList.push({targetVarName:t,fieldValues:_})}else r.updateAnswerRankingVOList=[{targetVarName:t,fieldValues:_}]}()}catch(e){console.error(e)}var t={};if(e.length>1){t={};for(var i=1;i<e.length;i++)e[i]&&2==e[i].length&&e[i][1]&&(t[e[i][0]]=e[i][1])}var data=JSON.stringify(t),_=this.survey.getServerCache?this.survey.getServerCache("findAnswerRanking",data):void 0;return void 0===_&&(_=jquery__WEBPACK_IMPORTED_MODULE_7___default.a.ajax({url:"/apiSurvey/survey/findAnswerRanking/"+this.survey.surveyId,data:data,method:"post",async:!1,dataType:"json",contentType:"application/json"}).responseJSON,this.survey.setServerCache&&this.survey.setServerCache("findAnswerRanking",data,_)),_.resultStatus?_.result:(element_ui__WEBPACK_IMPORTED_MODULE_8__.Message.error(_.message),"")}catch(e){console.error(e)}}},{key:"encrypt",value:function(e){var r=(e[0]||"").toString(),t=e[1]||this.survey.urlArgumentsGenerateKey;if(!r||!t)return"";var _=__webpack_require__(400),n=__webpack_require__(393)(t);return _.encrypt(r,n)}},{key:"decrypt",value:function(e){var r=e[0],t=e[1]||this.survey.urlArgumentsGenerateKey;if(!r||!t)return"";var _=__webpack_require__(400),n=__webpack_require__(393)(t);try{return _.decrypt(r,n)||r}catch(e){return r}}},{key:"registCustomeFunctionFactory",value:function(e,r,t){survey_knockout__WEBPACK_IMPORTED_MODULE_6__.FunctionFactory.Instance.register(e,r)}},{key:"unregistCustomeFunctionFactory",value:function(e){survey_knockout__WEBPACK_IMPORTED_MODULE_6__.FunctionFactory.Instance.unregister(e)}},{key:"getServerCache",value:function(e,r){if(e in this.serverCache)for(var i=0;i<this.serverCache[e].length;i++)if(this.serverCache[e][i].key==r)return this.serverCache[e][i].value}},{key:"setServerCache",value:function(e,r,t){e in this.serverCache&&(this.getServerCache(e,r)||this.serverCache[e].push({key:r,value:t}))}}])}()}}]);