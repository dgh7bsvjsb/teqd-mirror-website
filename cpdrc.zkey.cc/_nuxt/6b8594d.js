(window.webpackJsonp=window.webpackJsonp||[]).push([[558],{1367:function(t,e,n){"use strict";n.r(e);n(63),n(138);var r=n(1111);function o(t,data){return(data=data||{}).clientId=data.clientId||location&&location.host.replace(":","_"),data.origin=data.origin||location&&location.origin,data.redirectUri=data.redirectUri||(location?location.pathname+location.search:"")||"/",data.loginType=data.loginType||"password","".concat(c(t),"oauth/connect?client_id=").concat(data.clientId,"&response_type=").concat("code","&login_type=").concat(data.loginType,"&redirect_uri=").concat(encodeURIComponent(data.origin+"/account/callback?redirect_uri="+encodeURIComponent(data.redirectUri)),"&state=").concat(Object(r.a)())}function c(t){var e=t.authUrl||"https://auth2.zkey.cc/";return e&&e.lastIndexOf("/")!=e.length-1&&(e+="/"),e}e.default={getLoginSite:function(t){return function(){return c(t)}},getUserInfo:function(t){return function(e){return e?t.userInfo[e]:t.userInfo}},getClientId:function(t){return function(t){var e=t&&t.replace(":","_");return e||"undefined"==typeof location||(e=location&&location.host.replace(":","_")),e}},getSimulatedLoginUrl:function(t){return function(e){var n=location.host.replace(":","_");return"".concat(c(t),"oauth/connect?client_id=").concat(n,"&response_type=").concat("code","&login_type=switch_user&token=").concat(e,"&redirect_uri=").concat(encodeURIComponent(location.origin+"/account/callback?redirect_uri=/"),"&state=").concat(Object(r.a)())}},getLoginUrl:function(t){return function(data){return(data=data||{}).loginType=data.loginType||"password",o(t,data)}},getWxLoginUrl:function(t){return function(data){return(data=data||{}).loginType=data.loginType||"wx_login",o(t,data)}},getPasswordFindUrl:function(t){return function(data){return(data=data||{}).loginType="password_find",o(t,data)}},getRegisterUrl:function(t){return function(data){return(data=data||{}).loginType="register",o(t,data)}},getLogOutUrl:function(t){return function(data){return(data=data||{}).origin=data.origin||location.origin,data.redirectUri=data.redirectUri||location.href,c(t)+"oauth/logout?access_token="+t.token+"&redirect_uri="+encodeURIComponent(location.origin+"/account/callback?type=logout&redirect_uri="+encodeURIComponent(data.redirectUri))}},getSwitchUsersUrl:function(t,e){return function(){return c(t)+"oauth/logout?access_token="+t.token+"&redirect_uri="+encodeURIComponent(e.getLoginUrl())}},getSwitchExitUserUrl:function(t,e){return function(data){return(data=data||{}).loginType="switch_exit_user",o(t,data)}},getWxQcodeUrl:function(t,e){return function(data){return(data=data||{}).clientId=data.clientId||location.host.replace(":","_"),data.redirectUri=data.redirectUri||"/",c(t)+"oauth/wx_qcode?client_id="+data.clientId+"&redirect_uri="+encodeURIComponent(data.redirectUri)}}}},321:function(t,e,n){"use strict";n.r(e);var r=n(49),o=n(414),c=n(299);e.default=function(){return{simulatedUser:r.a.getSimulatedUser(),showFooter:!0,authUrl:"",token:"",refresh_token:"",logoutLoading:!1,siteInfo:{},userInfo:{},groupId:{},openGoods:{},openGoodsAuth:JSON.parse(JSON.stringify(c.defaultOpenGoodsAuth)),menu:[],backmenu:[],back_first_menu_url:"/console/home",authoritys:null,manageMenu:[],currentmenu:{},iconData:{},variable:{},plat:{active:r.a.getActivePlat(),visible:!1,refresh:!1},drawerSize:r.a.getDrawerSize()||"60%",activeMenus:[],leftExtInfo:{},activeMenu:{},project:{},projectAuth:[],projectAdmin:!1,dataSet:{},dataVar:{id:"",list:[]},dataSetAuth:[],dataSetAdmin:!1,pblType:"view",messageNum:{},pages:{articleList:"/page/",single:"/page/detail/",staticSingle:"/page/static/"},showChangePwd:!1,WXShareSign:!1,sysConfig:{},nameMap:o,dialogLoginData:{visible:!1,type:"login"},tokenStatus:!0,projectListStatus:!1,projectListLeft:200,isLeftHiden:!1}}},421:function(t,e,n){"use strict";n.r(e);var r=n(144),o=(n(48),n(60),n(46),n(63),n(76),n(49)),c=n(299),f=n(414),l=n(706);function h(t){for(var i=0;i<t.length;i++){var e=t[i];if(!(e.children&&e.children.length>0))return e.path;var path=h(e.children);if(path)return path}}e.default={setSysConfig:function(t,e){t.sysConfig=e},showFooter:function(t,e){t.showFooter=e,void 0===e&&(t.showFooter=!0)},changePwd:function(t,e){t.showChangePwd=void 0===e||e},setActiveMenus:function(t,e){t.activeMenus=Object.assign([],e)},setProjectInfo:function(t,e){t.project.id==e.id?t.project=Object.assign({},t.project,e):t.project=JSON.parse(JSON.stringify(e))},setProjectAuth:function(t,e){t.projectAuth=Object.assign([],e)},setProjectAdmin:function(t,e){t.projectAdmin=e},setProjectExtInfo:function(t,e){var n={};for(var i in e)switch(i){case"admin":n.charge=r(e[i]);break;case"participate":n.participant=r(e[i]);break;case"share":n.share=r(e[i]);break;case"recycle":n.deleted=r(e[i]);break;case"quit":n.quit=r(e[i])}function r(t){return t?"("+t+")":""}t.leftExtInfo=Object.assign({},t.leftExtInfo,n)},setMessageNum:function(t,e){var n=0;for(var i in e)n+=e[i];t.leftExtInfo=Object.assign({},t.leftExtInfo,{home:n?"(".concat(n,")"):""}),t.messageNum=Object.assign({},e,{sum:n})},setDataSetInfo:function(t,e){t.dataSet.id==e.id?(t.dataSet=Object.assign({},t.dataSet,JSON.parse(JSON.stringify(e))),t.dataSet.name=t.dataSet.title):(t.dataSet=JSON.parse(JSON.stringify(e)),e.title&&(t.dataSet.name=e.title))},setDataSetSplitCollection:function(t,e){t.dataSet.splitCollection=e},setDataSetAuth:function(t,e){t.dataSetAuth=Object.assign([],e)},setDataSetAdmin:function(t,e){t.dataSetAdmin=e},setDataVarList:function(t,e){var n=e.dataSetId,r=e.dataVarList,o=e.dataVarTree,data=e.data,c=e.loading;t.dataVar={id:n,data:data,list:JSON.parse(JSON.stringify(r||[])),tree:o?JSON.parse(JSON.stringify(o||[])):void 0,loading:c}},setVariableInfo:function(t,e){t.variable=JSON.parse(JSON.stringify(e))},setSiteInfo:function(t,e){if(e.homePage)try{e.homePage=JSON.parse(e.homePage)}catch(t){}else e.homePage="";t.siteInfo=Object.assign({},e),t.nameMap=Object.assign({},f),e.theme&&e.theme.nameMap&&e.theme.nameMap.forEach((function(e){e.key in f&&e.value&&(t.nameMap[e.key]=e.value)})),e.sysConfig&&(t.sysConfig=e.sysConfig)},setPblType:function(t,e){t.pblType=e},setMenu:function(t,menu){for(var i=0;i<menu.length;i++)"project"==menu[i].key&&(menu[i].position.includes("LEFT")||menu[i].position.push("LEFT"),e(menu[i].children,1));function e(menu,t){for(var i=0;i<menu.length;i++)menu[i].position.includes("LEFT")||menu[i].position.push("LEFT"),t<=2&&menu[i].children&&menu[i].children.length&&e(menu[i].children,t+1)}t.menu=menu},setBackMenu:function(t,e){t.backmenu=e;var n=h(e);t.back_first_menu_url=n||"/console/home"},setAuthoritys:function(t,data){t.authoritys=data,o.a.setCookieAES(o.a.AuthoritysKey,JSON.stringify(data))},getAuthoritys:function(t){var e=o.a.getCookieAES(o.a.AuthoritysKey);t.authoritys=e?JSON.parse(e):null},getCurrentBackMenu:function(t,e){t.backmenu=t.backmenu||[],t.currentmenu=null,this.commit("getChildernBackMenu",[t.backmenu,e])},getChildernBackMenu:function(t,e){var n=Object(r.a)(e,2),o=n[0],c=n[1],f=this;o&&l.from(o).forEach((function(e){t.currentmenu||(e.path==c?t.currentmenu=e:e.children&&e.children.length>0&&f.commit("getChildernBackMenu",[e.children,c]))}))},setToken:function(t,e){t.token=decodeURIComponent(e),e&&(t.tokenStatus=!0),o.a.setToken(e)},setRefreshToken:function(t,e){t.refresh_token=decodeURIComponent(e),o.a.setRefreshToken(e)},setActivePlat:function(t,e){t.plat.active=e,o.a.setActivePlat(e)},setDrawerSize:function(t,e){t.drawerSize=e,o.a.setDrawerSize(e)},setPlatVisible:function(t,e){t.plat.visible=e},setPlatRefresh:function(t,e){t.plat.refresh=e},setUserInfo:function(t,e){t.userInfo=Object.assign({},e),t.simulatedUser=!1,e?(e.simulatedUser&&(t.simulatedUser=!0),o.a.setUserId(e.id)):o.a.setUserId(""),o.a.setSimulatedUser(t.simulatedUser)},setOpenGoods:function(t,e){(e=JSON.parse(JSON.stringify(e||{})))&&e._package&&(e.package=e._package,delete e._package),t.openGoods=e,t.sysConfig&&t.sysConfig.packagePermissions?t.openGoodsAuth=Object(c.getAuthByOpenGoods)(e):t.openGoodsAuth=Object(c.getAuthByOpenGoods)()},setGroupId:function(t,e){var n=e.manage,r=e.participant;t.groupId={manage:n||t.groupId.manage||[],participant:r||t.groupId.participant||[]}},setSimulatedUser:function(t,e){t.simulatedUser=e,o.a.setSimulatedUser(e)},setAuthUrl:function(t,e){t.authUrl=decodeURIComponent(e),o.a.setAuthUrl(e)},setIconData:function(t,data){t.iconData=data},setActiveMenu:function(t,data){t.activeMenu=data},setLoginResetPassword:function(t,e){var n=t.userInfo.strategy||{};n.loginResetPassword=e,t.userInfo.strategy=n},setWXShareSign:function(t,e){t.WXShareSign=e},login:function(t,e){try{if(!window)return}catch(t){return}location.href=this.getters.getLoginUrl({redirectUri:e||""})},passwordFind:function(t){try{if(!window)return}catch(t){return}location.href=this.getters.getPasswordFindUrl()},switchUser:function(t,e){var n=this;e=this.getters.getSwitchUsersUrl({hostname:location.host.replace(":","_"),origin:location.origin,path:e||location.href.split(location.host)[1]});location.href=e,setTimeout((function(){n.commit("logout")}))},register:function(t){location.href=this.getters.getRegisterUrl({hostname:location.host.replace(":","_"),origin:location.origin,path:location.href.split(location.host)[1]})},logout:function(t){t.userInfo={},t.token="",t.refresh_token="",t.logoutLoading=!0,this.commit("setSimulatedUser",!1),o.a.removeToken(),o.a.removeRefreshToken(),o.a.removeUserId()},dialogLogin:function(t){try{if(!window)return}catch(t){return}t.dialogLoginData={visible:!0,type:"login"}},dialogRegister:function(t){try{if(!window)return}catch(t){return}t.dialogLoginData={visible:!0,type:"register"}},dialogForget:function(t){try{if(!window)return}catch(t){return}t.dialogLoginData={visible:!0,type:"forget"}},dialogLogout:function(t){try{if(!window)return}catch(t){return}this.commit("logout"),t.dialogLoginData={visible:!0,type:"logout"}},closeDialogLogin:function(t){try{if(!window)return}catch(t){return}t.tokenStatus=!0,t.dialogLoginData={visible:!1,type:"login"}},setTokenStatus:function(t,data){t.tokenStatus=data},setProjectListStatus:function(t,e){t.projectListStatus=e},setProjectListLeft:function(t,e){t.projectListLeft=e},setLeftHiden:function(t,e){t.isLeftHiden=e}}},633:function(t,e,n){"use strict";n.r(e);var r=n(68),o=(n(205),n(60),n(46),n(132),n(50),n(48),n(67),n(160),n(146),n(704),n(72),n(89),n(76),n(63),n(49)),c=n(53),f=n.n(c),l=n(444),h=n.n(l),d=n(384),m=n(285),S=n(556),v=n(69),k=n(676),I=function(){for(var t=[],e=[],i=0;i<m.length;i++)"project"==m[i].value?t=n(m[i].children):"dataSet"==m[i].value&&(e=n(m[i].children));return{PROJECT:t,DATASET:e};function n(t){var e=[];return t&&0!=t.length?(t.forEach((function(t){t.children&&t.children.length?e=e.concat(n(t.children)):e.includes(t.value)||e.push(t.value)})),e):e}}();function y(t,e){t&&t.$vueDataAc&&t.$vueDataAc.setUserToken(e||"")}Object(d.a)({$axios:f.a}),e.default={nuxtServerInit:function(t,e){return Object(r.a)(regeneratorRuntime.mark((function n(){var r,c,l,h,m,S,v,path,k,I,y,j,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.commit,c=t.dispatch,l=t.state,h=e.req,m=e.res,S=e.app,v=e.route,Object(d.a)({$axios:f.a,state:l}),path=(v&&v.path||"").toLowerCase(),k=l.token,I=l.refresh_token,h.cookies){if(k=o.a.getServerCookie(h,o.a.TokenKey)||k,r("setToken",k),k&&(k=decodeURIComponent(k)),I=o.a.getServerCookie(h,o.a.refreshTokenKey)||I,r("setRefreshToken",I),j=o.a.getServerCookie(h,o.a.SimulatedUserKey),r("setSimulatedUser","true"==j),w=o.a.getServerCookie(h,o.a.SiteKey))try{w=JSON.parse(decodeURIComponent(w)),r("setActivePlat",w)}catch(t){console.error(t)}y=o.a.getServerCookie(h,o.a.SiteAuthUrlKey)}return n.next=9,c("getSiteInfoServer",{req:h,res:m,app:S}).catch((function(t){}));case 9:if(l.siteInfo&&l.siteInfo.authUrl&&(y=l.siteInfo.authUrl),y&&null!=y&&"undefined"!=y||(y="https://auth2.zkey.cc/"),r("setAuthUrl",y),!k&&!I){n.next=19;break}return n.next=16,c("getUserInfoDetail",{req:h,app:S,token:k}).catch((function(t){}));case 16:if(!path.startsWith("/oa/")){n.next=19;break}return n.next=19,c("getGroupInfoServer",{req:h,app:S,token:k}).catch((function(){}));case 19:return n.next=21,c("getAuthoritysServer",{res:m,req:h,app:S,token:k}).catch((function(t){}));case 21:case"end":return n.stop()}}),n)})))()},getProjectInfo:function(t,e){var n=t.commit,r=t.dispatch,o=t.state;return new Promise((function(t,c){return e==o.project.id&&o.project.projectName?t(JSON.parse(JSON.stringify(o.project))):(n("setProjectInfo",{id:e}),n("setProjectAuth",[]),r("getProjectAuth",e),e===o.userInfo.id?(n("setProjectInfo",{id:e,projectName:"特殊项目"}),t(o.project)):void f()({method:"get",url:"project/project/findProject/"+e}).then((function(r){return r.resultStatus?(n("setProjectInfo",r.result),t(o.project)):(n("setProjectInfo",{id:e,projectName:void 0}),c(r))})).catch((function(t){return n("setProjectInfo",{id:e,projectName:void 0}),c(t)})))}))},changeProjectExtendVar:function(t,e){var n=t.commit,r=t.state,o=e.projectId,c=e.varName,l=e.value,data=JSON.parse(JSON.stringify(r.project));if(data.extendFields||(data.extendFields={}),"string"==typeof c)data.extendFields[c]=JSON.parse(JSON.stringify(l));else for(var i=0;i<c.length;i++)data.extendFields[c[i]]=JSON.parse(JSON.stringify(l[i]));return new Promise((function(t,e){f()({method:"post",url:"project/project/editProject/"+o,data:data}).then((function(r){r.resultStatus?(t(r.result),n("setProjectInfo",r.result)):e(r)})).catch((function(t){e(t)}))}))},getProjectAuth:function(t,e){var n=t.commit,r=t.state;if(n("setProjectAdmin",!1),e===r.userInfo.id){n("setProjectAdmin",!0);var o=[];for(var i in I.PROJECT)o.push(I.PROJECT[i]);return n("setProjectAuth",o),""}function c(){f()({method:"get",url:"project/team/findUserProjectAuth/"+e}).then((function(t){t.resultStatus&&n("setProjectAuth",t.result)}))}f()({method:"post",url:"project/team/checkIsProjectAdmin/"+e}).then((function(t){if(t.resultStatus&&t.result){n("setProjectAdmin",!0);var e=[];for(var i in I.PROJECT)e.push(I.PROJECT[i]);n("setProjectAuth",e)}else c()})).catch((function(t){c()}))},getProjectNum:function(t){var e=t.commit;f()({method:"get",url:"project/project/findDiffRoleProjectCount"}).then((function(t){t.resultStatus?e("setProjectExtInfo",t.result):e("setProjectExtInfo",{admin:0,participate:0,quit:0,recycle:0})})).catch((function(t){console.error(t),e("setProjectExtInfo",{admin:0,participate:0,quit:0,recycle:0})})),f()({method:"post",url:"project/publicResource/findProjectPublicCount"}).then((function(t){t.resultStatus?e("setProjectExtInfo",{share:t.result}):e("setProjectExtInfo",{share:0})})).catch((function(t){console.error(t),e("setProjectExtInfo",{share:0})}))},getMessageNum:function(t){var e=t.commit;f()({method:"post",url:"project/sysMessage/findMessageCountMap","not-prompt":!0}).then((function(t){t.resultStatus&&e("setMessageNum",t.result)}))},getDataSetInfo:function(t,e){var n=t.commit,r=t.dispatch,o=t.state,c=e.projectId,l=e.dataSetId;return new Promise((function(t,e){if(l==o.dataSet.id&&o.dataSet.name)return t(JSON.parse(JSON.stringify(o.dataSet)));n("setDataSetInfo",{id:l}),n("setDataSetAuth",[]),r("getDataSetAuth",{projectId:c,dataSetId:l}),f()({method:"get",url:"project/dataSet/findDataSetBaseInfo/"+l}).then((function(r){return r.resultStatus?(n("setDataSetInfo",r.result),t(JSON.parse(JSON.stringify(o.dataSet)))):e(r)})).catch((function(t){return e(t)}))}))},changeDataSetExtendVar:function(t,e){var n=t.commit,r=t.state,o=e.dataSetId,c=e.varName,l=e.value,data=JSON.parse(JSON.stringify(r.dataSet));if(data.extendFields||(data.extendFields={}),"string"==typeof c)data.extendFields[c]=JSON.parse(JSON.stringify(l));else for(var i=0;i<c.length;i++)data.extendFields[c[i]]=JSON.parse(JSON.stringify(l[i]));return new Promise((function(t,e){f()({method:"post",url:"project/dataSet/edit/"+o,data:data}).then((function(r){r.resultStatus?(t(r.result),n("setDataSetInfo",r.result)):e(r)})).catch((function(t){e(t)}))}))},getDataSetAuth:function(t,e){var n=t.commit,r=t.state,o=e.projectId,c=e.dataSetId;return new Promise((function(t,e){c==r.dataSet.id&&n("setDataSetAdmin",!1),f()({method:"post",url:"project/team/checkIsDataSetAdmin/"+o+"/"+c}).then((function(o){if(o.resultStatus&&o.result){var f=[];for(var i in I.DATASET)f.push(I.DATASET[i]);for(var i in S)f.push(S[i].key);c==r.dataSet.id&&(n("setDataSetAdmin",!0),n("setDataSetAuth",f)),t(f)}else l().then((function(e){t(e)})).catch((function(t){e(t)}))})).catch((function(n){l().then((function(e){t(e)})).catch((function(t){e(t)}))}))}));function l(){return new Promise((function(t,e){f()({method:"get",url:"project/team/findUserDataSetAuth/"+o+"/"+c}).then((function(o){o.resultStatus?(c==r.dataSet.id&&n("setDataSetAuth",o.result),t(o.result)):e(o)})).catch((function(t){console.error(t),e(t)}))}))}},getDataVarList:function(t,e){var n=t.commit,r=t.dispatch,o=t.state,c="",l="",h="";if(this.$router&&this.$router.app){var d=this.$router.app.$route;function S(t,e){for(var i in e)t+=t?"&".concat(i,"=").concat(e[i]):"?".concat(i,"=").concat(e[i]);return t}d.query&&d.query.publicResourceApplyId&&(c=S(c,{publicResourceApplyId:d.query.publicResourceApplyId})),l=d.params.projectId,h=d.params.dataSetId}var m={dataSetId:h,list:[],loading:!1};return new Promise((function(t,d){return h?e||h!=o.dataVar.id?(n("setDataVarList",{dataSetId:h,loading:!0}),void r("getDataSetInfo",{projectId:l,dataSetId:h}).then((function(e){var r=!0;"QUALITATIVE"==e.dataSetKindShape?f()({method:"post",url:"project/analysisData/findQualitativeFolders/".concat(l,"/").concat(h)}).then((function(e){if(r=!1,e.resultStatus){var o=e.result||[],c=l(JSON.parse(JSON.stringify(o)));d(c,"qualitative");var f={dataSetId:h,data:o,dataVarList:c,dataVarTree:c,loading:r};return n("setDataVarList",f),t(f);function l(t){for(var e=[],n=[],i=0;i<t.length;i++){for(var r=Object.assign({},t[i],{label:t[i].fileName,children:[],route:""}),o=n.map((function(t){return t.id})),c=e.length-1;c>=0;c--)e[c].parentId==r.id&&(r.children.splice(0,0,e[c]),e.splice(c,1));o.includes(r.parentId)?n[o.indexOf(r.parentId)].children.push(r):e.push(r),n.push(r)}return e}function d(t,e){for(var i=0;i<t.length;i++)t[i].route=e+"/"+t[i].id,t[i].children&&t[i].children.length&&d(t[i].children,t[i].route)}}return console.error(e.message),t(m)})).catch((function(e){return console.error(e),t(m)})):f()({method:"get",url:"project/metaVarial/find/"+h+"/1"+c}).then((function(o){if(r=!1,o.resultStatus){if("STATISTICAL"==e.dataSetKindShape){var c,f=v((null===(c=o.result)||void 0===c?void 0:c.indexDimension)||[]),l={dataSetId:h,dataVarList:f,data:o.result,loading:r};return n("setDataVarList",l),t(l);function v(t,e){for(var n=[],i=0;i<t.length;i++){var r=(e?e+"|":"")+t[i].varialName,o=Object.assign({},t[i],{id:t[i].id,nodeKey:r,children:v(t[i].children,r),label:t[i].varialName});n.push(o)}return n}}{var d=[];f=[];if(o.result)for(var i=0;i<o.result.length;i++){var S=JSON.parse(JSON.stringify(o.result[i]));S.visible&&(S.label=(S.varLabel||"")+(S.varName?"["+S.varName+"]":""),d.push(S))}l={dataSetId:h,data:o.result,dataVarList:d,dataVarTree:k(null),loading:r};return n("setDataVarList",l),t(l);function k(t){for(var e=[],i=0;i<d.length;i++)d[i].parentId==t&&(S=Object.assign({children:k(d[i].id)},d[i]),e.push(S));return e}}}return t(m)})).catch((function(e){return t(m)}))})).catch((function(e){return t(m)}))):t(o.dataVar):t(m)}))},getUserInfo:function(t){var e=t.commit,n=t.app,r=t.state;return new Promise((function(t,o){if(!r.token&&!r.refresh_token)return e("setUserInfo",{}),y(n,""),t({});f()({method:"post",url:"/oauth/auth/userinfo"}).then((function(r){return y(n,r&&r.result&&r.result.id),e("setUserInfo",r.result),r.result&&r.result.openGoods&&e("setOpenGoods",r.result.openGoods),t(r.result)})).catch((function(t){return o(t)}))}))},getUserInfoDetail:function(t,e){var n=t.commit,r=(t.state,e.req),o=e.app,c=e.token;return new Promise((function(t,e){if(!c)return n("setUserInfo",{}),y(o,""),t({});o.$axios({method:"post",url:"/oauth/auth/userinfo",headers:{host:r.headers.host,referer:r.protocol+"://"+r.headers.host,Authorization:c||"","x-requested-with":"// Removed for static mirror;return new Promise((function(t,e){if(!c)return n("setUserInfo",{}),y(o,""),t({});o.$axios({method:"post",url:"/oauth/auth/user",headers:{host:r.headers.host,referer:r.protocol+"://"+r.headers.host,Authorization:c||"","x-requested-with":"// Removed for static mirror;return new Promise((function(t,r){if(!n.token&&!n.refresh_token)return e("setOpenGoods",{}),t({});f()({method:"post",url:"oauth/auth/getMemberOpenGoods","not-redirect-login":!0}).then((function(n){return e("setOpenGoods",n.result),t(n.result)})).catch((function(t){return r(t)}))}))},getMemberOpenGoodsServer:function(t,e){var n=t.commit,r=(t.state,e.req),o=e.app,c=e.token;return new Promise((function(t,e){if(!c)return n("setOpenGoods",{}),t({});o.$axios({method:"post",url:"/oauth/auth/getMemberOpenGoods","not-redirect-login":!0,headers:{host:r.headers.host,referer:r.protocol+"://"+r.headers.host,Authorization:c||"","x-requested-with":"// Removed for static mirror;o.$axios({method:"post",url:"project/sysauthgroup/findUserManageGroupList",headers:{host:r.headers.host,referer:r.protocol+"://"+r.headers.host,Authorization:c||"","x-requested-with":"// Removed for static mirror;return o.forEach((function(t){c.includes(t.id)||c.push(t.id)})),n("setGroupId",{manage:c}),t({manage:c})}e(r)})).catch((function(t){return e(t)}))})),l=new Promise((function(t,e){if(!c)return n("setGroupId",{participant:[]}),t({});o.$axios({method:"post",url:"project/sysauthgroup/findUserParticipatoryList",headers:{host:r.headers.host,referer:r.protocol+"://"+r.headers.host,Authorization:c||"","x-requested-with":"// Removed for static mirror;return o.forEach((function(t){c.includes(t.id)||c.push(t.id)})),n("setGroupId",{participant:c}),t({participant:c})}e(r)})).catch((function(t){return e(t)}))}));return Promise.all([f,l])},getGroupInfo:function(t){var e=t.commit,n=t.state,r=new Promise((function(t,r){if(!n.token)return e("setGroupId",{manage:[]}),t({});f()({method:"post",url:"project/sysauthgroup/findUserManageGroupList",data:{pageIndex:0,pageSize:100}}).then((function(n){if(n.resultStatus){var o=n.result.content||[],c=[];return o.forEach((function(t){c.includes(t.id)||c.push(t.id)})),e("setGroupId",{manage:c}),t({manage:c})}r(n)})).catch((function(t){return r(t)}))})),o=new Promise((function(t,r){if(!n.token)return e("setGroupId",{participant:[]}),t({});f()({method:"post",url:"project/sysauthgroup/findUserParticipatoryList",data:{pageIndex:0,pageSize:100}}).then((function(n){if(n.resultStatus){var o=n.result.content||[],c=[];return o.forEach((function(t){c.includes(t.id)||c.push(t.id)})),e("setGroupId",{participant:c}),t({participant:c})}r(n)})).catch((function(t){return r(t)}))}));return Promise.all([r,o])},getSysConfig:function(t,e){var n=t.commit,r=(t.state,e.req),c=e.res,f=e.app;return new Promise((function(t,e){var l=Object(v.getRefererByHost)(r.headers.host);f.$axios({method:"get",url:"project/system/systemConfig",headers:{host:r.headers.host,referer:l,"x-requested-with":"// Removed for static mirror;var r=data.result,f=r&&r.shareToken||!1;return o.a.setServerCookie(c,o.a.shareTokenKey,f),t(data.result)}return console.info("getSysConfig",l),e(data)})).catch((function(t){return console.info("getSysConfig",l),e(t)}))}))},getSiteInfoServer:function(t,e){var n=t.commit,r=(t.state,e.req),c=e.res,f=e.app,l=Object(v.getRefererByHost)(r.headers.host);return new Promise((function(t,e){f.$axios({method:"post",url:"oauth/common/siteinfo",headers:{host:r.headers.host,referer:l,"x-requested-with":"// Removed for static mirror;var r=data.result.sysConfig;if(r){var f=r&&r.shareToken||!1;o.a.setServerCookie(c,o.a.shareTokenKey,f)}return t(data.result)}return console.info("getSiteInfoServer",l,data),e(data)})).catch((function(t){return console.info("getSiteInfoServer",l,t),e(t)}))}))},getSiteInfo:function(t){var e=t.commit;t.state;return new Promise((function(t,n){f()({method:"post",url:"oauth/common/siteinfo",data:{weburl:location.origin}}).then((function(r){if(r&&200==r.status){e("setSiteInfo",r.result);var c=r.result.sysConfig;if(c){var f=c&&c.shareToken||!1;o.a.setCookie(o.a.shareTokenKey,f)}return t(r.result)}return n(r)})).catch((function(t){return n(t)}))}))},setToken:function(t,e){var n=t.commit,r=t.dispatch;return n("setToken",e),r("getMemberOpenGoods").catch((function(){})),new Promise((function(t,e){r("getUserInfo").then((function(e){return t(e)})).catch((function(t){return e(t)}))}))},simulatedLogin:function(t,e){t.commit,t.state;var n=t.getters;return new Promise((function(t,r){f()({method:"post",url:"/platmanage/user/generateSwitchUserToken/".concat(e)}).then((function(t){if(t){if(!t||200!=t.status)return r(t);var e=n.getSimulatedLoginUrl(t.result);location.href=e}})).catch((function(t){return r(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t,n){f()({method:"post",url:"oauth/oauth/logout"}).then((function(n){return e("logout"),t(n)})).catch((function(t){return n(t)}))}))},getAuthoritysServer:function(t,e){var n=t.commit,r=(t.state,e.res),c=e.req,f=e.app,l=e.token;return new Promise((function(t,e){f.$axios({method:"post",url:"/oauth/auth/authoritys",headers:{host:c.headers.host,referer:c.protocol+"://"+c.headers.host,Authorization:l||"","x-requested-with":"// Removed for static mirror;if(c&&c.length>0)for(var l=0;l<c.length;l++)f.push(c[l].key);return n("setAuthoritys",f),o.a.setServerCookieAES(r,"ZKEY_AUTHORITYS",JSON.stringify(f)),t(c)}return e(r)})).catch((function(t){return e(t)}))}))},getAuthoritys:function(t){var e=t.commit;t.state;return new Promise((function(t,n){f()({method:"post",url:"/oauth/auth/authoritys","not-redirect-login":!0}).then((function(r){if(r&&200==r.status){var o=r.result,c=[];if(o&&o.length>0)for(var f=0;f<o.length;f++)c.push(o[f].key);return e("setAuthoritys",c),t(r.result)}return n(r)})).catch((function(t){return n(t)}))}))},getBackMenu:function(t,e){var n=t.commit,r=t.state;return new Promise((function(t,o){if(!(e=e||!1)&&r.backmenu&&r.backmenu.length>0)return t(r.backmenu);f()({method:"post",url:"/oauth/auth/back_modules","not-redirect-login":!0,data:{type:[1,4]}}).then((function(e){var o;function c(t){var e=[];if(t&&t.length>0)for(var n=0;n<t.length;n++)e.push(t[n].key);return e}return o=function t(e){var n=[];if(e&&e.length>0)for(var r=0;r<e.length;r++){var menu={id:e[r].id,name:e[r].name,type:e[r].type,path:e[r].path,icon:e[r].icon,pid:e[r].pid,redirect:e[r].redirect,target:e[r].target,children:t(e[r].children),authoritys:c(e[r].authoritys)};n.push(menu)}return n}(e.result),n("setBackMenu",o),t(r.backmenu)})).catch((function(t){return o(t)}))}))},getMenu:function(t,e){var n=t.commit,r=t.state;return new Promise((function(t,o){if(!(e=e||!1)&&r.menu&&r.menu.length>0)return t(r.menu);f()({method:"post",url:"/oauth/auth/modules","not-redirect-login":!0,data:{type:[1,4]}}).then((function(e){var o;function c(t){var e=[];if(t&&t.length>0)for(var n=0;n<t.length;n++)e.push(t[n].key);return e}return o=function t(e){var n=[];if(e&&e.length>0)for(var r=0;r<e.length;r++)n.push(Object.assign({},e[r],{children:t(e[r].children),authoritys:c(e[r].authoritys)}));return n}(e.result),n("setMenu",o),t(r.menu)})).catch((function(t){return o(t)}))}))},getIconData:function(t){t.commit,t.state;return new Promise((function(t,e){return t(k)}))},resetWXShareData:function(t,e){var n=t.dispatch,r=t.state;n("updateWXShareData",{title:r.siteInfo.title,desc:r.siteInfo.seoDesc,imgUrl:r.siteInfo.logo,isFirst:e})},updateWXShareData:function(t,e){var n=t.commit,r=t.state,title=e.title,desc=e.desc,link=e.link,o=e.imgUrl,c=e.isFirst;try{if(!Object(v.os)().isWeixin||!c&&!r.WXShareSign)return}catch(t){return}f()({method:"get",url:"oauth/common/get_wx_jsapi_ticket"}).then((function(t){t.resultStatus?(n("setWXShareSign",!0),function(t){var title=t.title,desc=t.desc,link=t.link,e=t.imgUrl,n=t.appId,r=t.jsapi_ticket,o=(new Date).valueOf().toString().slice(0,10),c=Object(v.randomString)(18),f=location.href.split("#")[0],l=h()("jsapi_ticket=".concat(r,"&noncestr=").concat(c,"&timestamp=").concat(o,"&url=").concat(f));wx.config({debug:!1,appId:n,timestamp:o,nonceStr:c,signature:l,jsApiList:["updateAppMessageShareData","updateTimelineShareData"]}),wx.ready((function(){var t={title:title,desc:desc,link:link||f,imgUrl:e,success:function(){}};wx.updateAppMessageShareData(t),wx.updateTimelineShareData(t);try{wx.onMenuShareAppMessage(t),wx.onMenuShareTimeline(t)}catch(t){}}))}({title:title,desc:desc,link:link,imgUrl:o,appId:t.result.appid,jsapi_ticket:t.result.ticket})):n("setWXShareSign",!1)})).catch((function(t){n("setWXShareSign",!1)}))},refresh_token:function(t){var e=t.commit,n=t.state;return new Promise((function(t,r){if(!n.refresh_token)return r("");f()({method:"post",url:"/user/token/refresh_token",data:{client_id:location.host.replace(":","_"),refresh_token:n.refresh_token}}).then((function(n){return n.access_token?(e("setToken",n.token_type+" "+n.access_token),e("setRefreshToken",n.refresh_token),t(n.token_type+" "+n.access_token)):r("")})).catch((function(t){return r("")}))}))},refresh_token_server:function(t,e){var n=t.commit,r=t.state,o=e.req,c=e.app;return new Promise((function(t,e){if(!r.refresh_token)return e("");c.$axios({method:"post",url:"/user/token/refresh_token",headers:{host:o.headers.host,"x-requested-with":"// Removed for static mirror;