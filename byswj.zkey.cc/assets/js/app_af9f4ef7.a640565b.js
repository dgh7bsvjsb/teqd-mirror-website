(window.webpackJsonp=window.webpackJsonp||[]).push([["app~af9f4ef7"],{"8ead":function(e,t,r){"use strict";r.r(t),r.d(t,"color",(function(){return n})),r.d(t,"GlobalConfig",(function(){return s}));var n=r("02f0"),s={defaultCompletedBeforeHtml:"",defaultCompletedHtml:"",defaultRepeatedHtml:""}},a4d6:function(e,t,r){"use strict";var n=r("bc3a"),s=r.n(n),i=r("9a2f"),a=r("5c96");s.a.defaults.headers.post["X-Requested-With"]="// Removed for static mirror;var u=[];function o(){u&&(1==u.length&&u[0].close(),u.length>0&&u.splice(0,1))}function l(e){e.status=e.status||"",o();var t="请求出错"+e.status+"！";Object(a.Message)({message:t,type:"error"})}(new Date).valueOf(),(new Date).valueOf(),s.a.interceptors.request.use((function(e){(new Date).valueOf(),function(e){e=e||"",u.push(a.Loading.service())}(e.showLoadingTime);var t=i.a.sign("get"==e.method?function(e){if(e&&"-1"!=e.indexOf("?")){for(var t=e.slice(e.indexOf("?")+1).split("&"),r={},n=0;n<t.length;n++){var s=t[n].split("=");2==s.length?r[s[0]||""]=s[1]:r[""]=s[0]}return r}}(e.url):e.data);if(t)for(var r in t)e.headers[r]=t[r];return e}),l),s.a.interceptors.response.use((function(e){(new Date).valueOf(),o(),e.data;var t=e.status;if(t>="500"&&t<="599.99")l(e);else if(t>="400"&&t<="499.99")l(e);else if(t>="300"&&t<="399.99")l(e);else{if(t>="200"&&t<="299.99")return Promise.resolve(e.data);t<"200"&&l(e)}return Promise.resolve(e)}),l),t.a=s.a},ada6:function(e,t,r){"use strict";r.r(t),r.d(t,"encrypt",(function(){return S})),r.d(t,"decrypt",(function(){return w}));var n=r("448a"),s=r.n(n),i=16,a=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],u=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];function o(e){for(var t=[],r=0,n=e.length;r<n;r+=2)t.push(parseInt(e.substr(r,2),16));return t}function l(e){return e.map((function(e){return 1===(e=e.toString(16)).length?"0"+e:e})).join("")}function c(e){for(var t=[],r=0,n=e.length;r<n;r++){var s=e.codePointAt(r);if(s<=127)t.push(s);else if(s<=2047)t.push(192|s>>>6),t.push(128|63&s);else if(s<=55295||s>=57344&&s<=65535)t.push(224|s>>>12),t.push(128|s>>>6&63),t.push(128|63&s);else{if(!(s>=65536&&s<=1114111))throw t.push(s),new Error("input is not supported");r++,t.push(240|s>>>18&28),t.push(128|s>>>12&63),t.push(128|s>>>6&63),t.push(128|63&s)}}return t}function d(e){for(var t=[],r=0,n=e.length;r<n;r++)e[r]>=240&&e[r]<=247?(t.push(String.fromCodePoint(((7&e[r])<<18)+((63&e[r+1])<<12)+((63&e[r+2])<<6)+(63&e[r+3]))),r+=3):e[r]>=224&&e[r]<=239?(t.push(String.fromCodePoint(((15&e[r])<<12)+((63&e[r+1])<<6)+(63&e[r+2]))),r+=2):e[r]>=192&&e[r]<=223?(t.push(String.fromCodePoint(((31&e[r])<<6)+(63&e[r+1]))),r++):t.push(String.fromCodePoint(e[r]));return t.join("")}function p(e,t){return e<<t|e>>>32-t}function f(e){return(255&a[e>>>24&255])<<24|(255&a[e>>>16&255])<<16|(255&a[e>>>8&255])<<8|255&a[255&e]}function h(e){return e^p(e,2)^p(e,10)^p(e,18)^p(e,24)}function v(e){return e^p(e,13)^p(e,23)}function y(e,t,r){for(var n=new Array(4),s=new Array(4),i=0;i<4;i++)s[0]=255&e[4*i],s[1]=255&e[4*i+1],s[2]=255&e[4*i+2],s[3]=255&e[4*i+3],n[i]=s[0]<<24|s[1]<<16|s[2]<<8|s[3];for(var a,u=0;u<32;u+=4)a=n[1]^n[2]^n[3]^r[u+0],n[0]^=h(f(a)),a=n[2]^n[3]^n[0]^r[u+1],n[1]^=h(f(a)),a=n[3]^n[0]^n[1]^r[u+2],n[2]^=h(f(a)),a=n[0]^n[1]^n[2]^r[u+3],n[3]^=h(f(a));for(var o=0;o<16;o+=4)t[o]=n[3-o/4]>>>24&255,t[o+1]=n[3-o/4]>>>16&255,t[o+2]=n[3-o/4]>>>8&255,t[o+3]=255&n[3-o/4]}function g(e,t,r){for(var n=new Array(4),s=new Array(4),i=0;i<4;i++)s[0]=255&e[0+4*i],s[1]=255&e[1+4*i],s[2]=255&e[2+4*i],s[3]=255&e[3+4*i],n[i]=s[0]<<24|s[1]<<16|s[2]<<8|s[3];n[0]^=2746333894,n[1]^=1453994832,n[2]^=1736282519,n[3]^=2993693404;for(var a,o=0;o<32;o+=4)a=n[1]^n[2]^n[3]^u[o+0],t[o+0]=n[0]^=v(f(a)),a=n[2]^n[3]^n[0]^u[o+1],t[o+1]=n[1]^=v(f(a)),a=n[3]^n[0]^n[1]^u[o+2],t[o+2]=n[2]^=v(f(a)),a=n[0]^n[1]^n[2]^u[o+3],t[o+3]=n[3]^=v(f(a));if(0===r)for(var l,c=0;c<16;c++)l=t[c],t[c]=t[31-c],t[31-c]=l}function m(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=n.padding,u=void 0===a?"pkcs#7":a,p=n.mode,f=n.iv,h=void 0===f?[]:f,v=n.output,m=void 0===v?"string":v;if("cbc"===p&&("string"==typeof h&&(h=o(h)),16!==h.length))throw new Error("iv is invalid");if("string"==typeof t&&(t=o(t)),16!==t.length)throw new Error("key is invalid");if(e="string"==typeof e?0!==r?c(e):o(e):s()(e),("pkcs#5"===u||"pkcs#7"===u)&&0!==r)for(var S=i-e.length%i,w=0;w<S;w++)e.push(S);var k=new Array(32);g(t,k,r);for(var x=[],b=h,A=e.length,O=0;A>=i;){var I=e.slice(O,O+16),L=new Array(16);if("cbc"===p)for(var C=0;C<i;C++)0!==r&&(I[C]^=b[C]);y(I,L,k);for(var R=0;R<i;R++)"cbc"===p&&0===r&&(L[R]^=b[R]),x[O+R]=L[R];"cbc"===p&&(b=0!==r?L:I),A-=i,O+=i}if(("pkcs#5"===u||"pkcs#7"===u)&&0===r){for(var P=x.length,q=x[P-1],N=1;N<=q;N++)if(x[P-N]!==q)throw new Error("padding is invalid");x.splice(P-q,q)}return"array"!==m?0!==r?l(x):d(x):x}function S(e,t,r){return m(e,t,1,r)}function w(e,t,r){return m(e,t,0,r)}},cbd0:function(e,t,r){"use strict";var n=r("970b"),s=r.n(n),i=r("5bc3"),a=r.n(i),u=r("9523"),o=r.n(u),l=r("b038"),c=r("bc3a"),d=r.n(c),p=r("5c96");function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function h(e){for(var t={},r=document.cookie.split("; "),n=0;n<r.length;n++){var s=r[n].split("=");t[s[0]]=s[1]}return e?t[e]:t}var v=function(){function e(){s()(this,e),o()(this,"mobile",void 0),o()(this,"token",void 0),o()(this,"interval",void 0),o()(this,"uuid",void 0),o()(this,"survey",void 0),o()(this,"getSurveyJsonAndIsCompleted",(new l.dxSurveyService).getSurveyJsonAndIsCompleted),this.uuid=h("uuid")||window.localStorage.getItem("uuid");var t=new Date((new Date).getTime()+31536e8);this.uuid?h("uuid")||(document.cookie="uuid=".concat(this.uuid,"; expires=").concat(t,"; path=/")):(this.uuid=f(),window.localStorage.setItem("uuid",this.uuid),document.cookie="uuid=".concat(this.uuid,"; expires=").concat(t,"; path=/")),this.modifyDxSurveyService()}return a()(e,[{key:"modifyDxSurveyService",value:function(){var e=this;l.dxSurveyService.prototype.getResult=function(e,t,r){var n=new // Removed for static mirror;n.open("GET",l.dxSurveyService.serviceUrl+"/getResult?"+s),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("Authorization","ZHLn+GZxz80eJEHNjRPWxRflu4vv1c0VyxOKM4gbr8q0CLtVLd9gamemj4VbP/qA"),n.onload=function(){var e=null,t=new Array;if(200==n.status)for(var s in t=[],(e=JSON.parse(n.response)).QuestionResult){var i={name:s,value:e.QuestionResult[s]};t.push(i)}r(200==n.status,e,t,n.response)},n.send()},l.dxSurveyService.prototype.getSurveyJsonAndIsCompleted=function(e,t,r){var n=new XMLHttpRequest;n.open("GET",l.dxSurveyService.serviceUrl+"/getSurveyAndIsCompleted?surveyId="+e+"&clientId="+t),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("Authorization","ZHLn+GZxz80eJEHNjRPWxRflu4vv1c0VyxOKM4gbr8q0CLtVLd9gamemj4VbP/qA"),n.onload=function(){var e=JSON.parse(n.response),t=e?e.survey:null,s=e?e.isCompleted:null;r(200==n.status,t,s,n.response)},n.send()},l.dxSurveyService.prototype.isCompleted=function(e,t,r){var n=new // Removed for static mirror;n.open("GET",l.dxSurveyService.serviceUrl+"/isCompleted?"+s),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("Authorization","ZHLn+GZxz80eJEHNjRPWxRflu4vv1c0VyxOKM4gbr8q0CLtVLd9gamemj4VbP/qA"),n.onload=function(){var e=null;200==n.status&&(e=JSON.parse(n.response)),r(200==n.status,e,n.response)},n.send()},l.dxSurveyService.prototype.loadSurvey=function(t,r){d()({method:"get",url:"/apiSurvey/survey/FindQuestionnaire/"+t+"?r="+Math.random()}).then((function(t){t.resultStatus?(r&&r(t.resultStatus,t.result,t),e.token=t.result.token,e.survey=t.result.publishQuestionnaireModel.jsonContentObject,setTimeout((function(){e.setWXShareData(e.survey)}),1e3)):($(".refuse-box").hide(),r&&r(t.resultStatus,t.result,t))})).catch((function(e){$(".refuse-box").hide()}))},l.dxSurveyService.prototype.sendFile=function(e,t,n){var s=r("2071").default,i=new // Removed for static mirror;i.onload=i.onerror=function(){if(a.close(),n)if(200==i.status)try{var e=JSON.parse(i.response);e.resultStatus?n(200==i.status,e.result.url):p.Message.error(e.message||"上传失败")}catch(e){p.Message.error("上传失败")}else p.Message.error("上传失败")},i.upload.onprogress=function(e){a.update((e.loaded/e.total*100).toFixed(2))},i.open("POST","/apiFile/file/uploadPublic?path=surveyAnswer",!0);var u=new FormData;u.append("file",t),i.send(u)},l.dxSurveyService.prototype.sendResult=function(t,r,n,s,i){var a=p.Loading.service({lock:!0,text:"问卷提交中，请勿关闭本页面",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)",customClass:"survey-loading"}),u={};r.pages.forEach((function(e){u[e.name]=e.timeSpent}));var o={postId:t,surveyResult:JSON.stringify(r)},l=JSON.parse(JSON.stringify(r.data));e.handleOther(l),s&&(o.clientId=s),r.isPartialCompleted&&(o.isPartialCompleted=!0);var c=e.uuid||f();"completed"==r.state&&e.saveUserAction(r.token,{operateRecord:{userAction:r.userAction},shortLink:r.responseData.result.publishQuestionnaireModel.shortLink,qid:r.responseData.result.publishQuestionnaireModel.qid,uuid:c,zkeyUserInfo:l.zkeyUserInfo||void 0}),d()({method:"POST",headers:{Authorization:r.token,ContentType:"application/json;charset=UTF-8"},data:{answerContentObject:l,publishVersion:r.responseData.result.publishQuestionnaireModel.publishVersion,qid:r.responseData.result.publishQuestionnaireModel.qid,startToFinish:function(){try{return parseInt(((r.userAction[r.userAction.length-1].tt-r.userAction[0].tt)/1e3).toString())}catch(e){return 0}}(),isCompleted:r.isCompleted,startAnswerDate:r.startAnswerDate||r.responseData.timeSpan,weChatUserInfo:r.weChatUserInfo||{},openId:r.weChatUserInfo?r.weChatUserInfo.openid:"",mobile:e.mobile,timeDifference:parseInt((r.timeDifference/1e3).toString())||"0",uuid:c,userAgent:window.navigator.userAgent,userKeyId:r.userKeyId||c,screenAvailWidth:screen.availWidth,screenAvailHeight:screen.availHeight,shortLink:r.responseData.result.publishQuestionnaireModel.shortLink,timePerPage:JSON.stringify(u),updateAnswerRankingVOList:function(){var e=[];if(!r.updateAnswerRankingVOList)return[];for(var t=0;t<r.updateAnswerRankingVOList.length;t++){for(var n={},s=0;s<r.updateAnswerRankingVOList[t].fieldValues.length;s++){var i=r.updateAnswerRankingVOList[t].fieldValues[s];n[i]=r.data[i]||""}e.push({targetVarName:r.updateAnswerRankingVOList[t].targetVarName,fieldValues:n})}return e}()},url:"/apiSurvey/survey/SaveAnswer"}).then((function(t){a.close(),null!=t&&t.resultStatus?(n(t.resultStatus,t||{}),clearInterval(e.interval),e.interval=void 0):n(!(null==t||!t.resultStatus),t||{})})).catch((function(e){a.close(),n(!1,{})}))}}},{key:"handleOther",value:function(e){for(var t in e){if(t.match(/_Other$/g))e[t.slice(0,t.length-6)+"-Other"]=e[t];if(Array.isArray(e[t]))for(var r=0;r<e[t].length;r++)this.handleOther(e[t][r])}}},{key:"getQueryString",value:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),r=window.location.search.substr(1).match(t);return null!=r?decodeURI(r[2]):""}},{key:"getLoginPublic",value:function(e){var t=this,r={userName:e.userName||"",password:e.passWord||""};d()({method:"POST",data:JSON.stringify(r),url:"/apiSurvey/survey/LoginByShortLink/"+e.shortLink+"?uuid="+this.uuid}).then((function(r){r.resultStatus?(r.result&&r.result.userInfo&&t.pollingFun(r.result.userInfo.qid,r.result.userInfo.userName),e.callBack(!!r.resultStatus,r)):e.callBack(!!r.resultStatus,r)})).catch((function(e){}))}},{key:"telLogin",value:function(e){var t=this,r={userName:e.userName||"",password:e.passWord||""},n=this.uuid;d()({method:"POST",data:JSON.stringify(r),url:"/apiSurvey/survey/LoginByVerifyCode/"+e.shortLink+"?uuid="+this.uuid}).then((function(r){r.resultStatus?(r.result.userInfo&&t.pollingFun(r.result.userInfo.qid,r.result.userInfo.userName),t.mobile=r.result.keyId,d()({method:"POST",url:"/apiSurvey/survey/AnswerCheck/"+r.result.publishQuestionnaireModel.shortLink,data:{openid:"",uuid:n,mobile:r.result.keyId}}).then((function(t){if(Object.keys(t).length>0){var n="",s=Object.keys(t||{})||[];switch(!0){case s.includes("error"):n=t.error||"未知错误，请联系项目联系人。";break;case s.includes("openId"):n="您已完成填答，感谢您的支持！";break;case s.includes("ipAddress"):n="本设备所用公网IP填答数量已达上限，感谢您的支持！";break;case s.includes("device"):n="本设备填答数量已达上限，感谢您的支持！";break;case s.includes("mobile"):n="本手机号已填答，感谢您的支持！";break;default:n="未知限制，请联系项目联系人。"}$(".refuse-box").html(n).show(),$("#surveyElement").hide(),e.callBack(!1,r)}else e.callBack(!!r.resultStatus,r),$(".refuse-box").hide()}))):e.callBack(!!r.resultStatus,r)}))}},{key:"passwordLogin",value:function(e){var t=this,r={userName:e.userName||""};d()({method:"POST",data:JSON.stringify(r),url:"/apiSurvey/survey/LoginByAccessPassword/"+e.shortLink+"?uuid="+this.uuid}).then((function(r){r.resultStatus?(t.pollingFun(r.result.publishQuestionnaireModel.qid,e.userName),e.callBack(!!r.resultStatus,r)):e.callBack(!!r.resultStatus,r)}))}},{key:"doServerValidation",value:function(){}},{key:"creatCaptcha",value:function(e,t){var r={userName:e.telLoginTelNum||"",password:""};d()({method:"POST",data:JSON.stringify(r),url:"/apiSurvey/survey/SendVerifyCode/"+e.surveyId}).then((function(e){e.resultStatus,t(e.resultStatus,e)}))}},{key:"getUserInfo",value:function(e,t){var r=this;d()({method:"POST",url:"/apiZkeyUser/auth/userinfo",headers:{Authorization:e}}).then((function(e){e.resultStatus?t(e.resultStatus,e):r.loginByZkeyUser()})).catch((function(e){}))}},{key:"loginByZkeyUser",value:function(){var e="oauth/connect?redirect_uri=".concat(encodeURIComponent(window.location.origin+"/callback?pathname="+window.location.pathname),"&client_id=").concat(window.location.host.replace(":","_"),"&response_type=token&login_type=password");d()({method:"POST",data:{},url:"/apiZkeyUser/common/siteinfo"}).then((function(t){if(t.resultStatus){var r=t.result.authUrl+e;window.location.href=r}else p.Message.error(t.message||"获取登录信息失败")})).catch((function(e){p.Message.error("获取登录信息失败")}))}},{key:"pollingFun",value:function(e,t){var r=this;this.survey&&this.survey.prohibitMultipleLogin&&(this.interval=setInterval((function(){$.ajax({url:"/apiSurvey/survey/refreshExpirationTime/"+e+"?uuid="+r.uuid,type:"post",data:t,contentType:"application/json",headers:{Authorization:r.token}})}),3e3))}},{key:"setWXShareData",value:function(e){var t=r("3ed8"),n=t.os,s=t.setWXShareData;try{if(!n().isWeixin)return}catch(e){return}d()({method:"get",url:"apiZkeyUser/common/get_wx_jsapi_ticket"}).then((function(t){t.resultStatus&&s({title:e.title,desc:e.wxShareDes||e.description,imgUrl:e.wxShareImg||e.previewImg,appId:t.result.appid,jsapi_ticket:t.result.ticket})})).catch((function(e){}))}},{key:"saveUserAction",value:function(e,t){d()({method:"post",url:"/apiSurvey/survey/SaveAnswerOperateRecord",headers:{Authorization:e,ContentType:"application/json;charset=UTF-8"},data:t})}}]),e}();t.a=v}}]);